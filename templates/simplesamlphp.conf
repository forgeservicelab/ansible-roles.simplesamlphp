<VirtualHost *:443>
    ServerName {{ simplesamlphp_fqdn }}

    {% if simplesamlphp_suburi %}

    DocumentRoot /var/www/html
    RedirectMatch ^/$ /{{ simplesamlphp_suburi }}
    Alias /{{ simplesamlphp_suburi }} {{ simplesamlphp_dir }}/www

    {% else %}

    DocumentRoot {{ simplesamlphp_dir }}/www

    {% endif %}

    SSLEngine on
    SSLProtocol -ALL +TLSv1 +TLSv1.1 +TLSv1.2
    SSLCipherSuite !DH:EECDH+ECDSA+AESGCM:EECDH+aRSA+AESGCM:EECDH+ECDSA+SHA384:EECDH+ECDSA+SHA256:EECDH+aRSA+SHA384:EECDH+aRSA+SHA256:EECDH+aRSA+RC4:EECDH:EDH+aRSA:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!PSK:!SRP:!DSS:!RC4
    SSLCertificateFile /etc/ssl/forgeservicelab.fi.crt
    SSLCertificateChainFile /etc/ssl/forgeservicelab.fi.crt.chain
    SSLCertificateKeyFile /etc/ssl/forgeservicelab.fi.key
    SetEnvIf User-Agent ".*MSIE.*" \
         nokeepalive ssl-unclean-shutdown \
         downgrade-1.0 force-response-1.0

    <Directory {{ simplesamlphp_dir }}>
        AllowOverride None
        Require all granted
    </Directory>


</VirtualHost>

<VirtualHost *:80>
    ServerName {{ simplesamlphp_fqdn }}
    Redirect / https://{{ simplesamlphp_fqdn }}
</VirtualHost>
